\todoi{
	Construct an argument to support the use of heuristics to find a variable that optimizes the
	amount of active symmetries
}

The authors of \cite{devriendt2012symmetry,katebi2010symmetry} \todo{Does \cite{katebi2010symmetry} really suggest this?} suggest the possibility of optimizing the solver by
branching on literals that optimize the number of symmetries that are (weakly) active.
They took a step in that direction by lowering the position of \emph{inverting} literals $v$ on the variable heap for
every symmetry $\sigma$ such that $\sigma(v) = \neg v$.
Because choosing such variables would cause these symmetries to become permanently weakly inactive.
Using this heuristic they showed a considerable performance boost, which prompted our research.

In this section we consider several implementations of this heuristic: promoting choice literals
that keep or make symmetries weakly active.
In the next section we compare the performance of these implementations and discuss their
applicability.

\subsection{Literal Lookahead}
	To also consider the effects of choice literals on the activity of symmetries further,
	we propose a heuristic \emph{literal lookahead} that checks if symmetries are made weakly inactive by a choice literal.
	Given the definition of weak activity in \cite{devriendt2012symmetry} we can define \cref{cor:makes_inactive}.\\

	\begin{corollary}
		\label{cor:makes_inactive}
		Given a symmetry $\sigma$ and a choice literal $l$,
		$\sigma$ is made weakly inactive by choosing $l$ iff
		$\sigma$ is weakly active, and $\sigma(l) \notin \alpha$.
		Where $(\alpha,\delta,\textit{expl})$ is the solver state \textbf{after} unit propagation of $l$. \todo{Can we express this differently?}
	\end{corollary}

	In order to determine the activity of symmetries exactly after choosing a literal,
	it is necessary to perform the unit propagation step under the assumption that the literal is chosen.
	Performing a lookahead is an expensive operation as it requires the solver to perform half an
	iteration and backtrack.

	In fact, it is necessary to perform $|L|$ lookaheads, where $L = \bar{\Sigma}(T)$ is the set of literals.\todo{Need proofread on runtime complexity}
	And each lookahead consists of a unit propagation and a symmetry propagation step.
	The unit propagation phase iterates through all clauses in a time complexity of $O(|T|)$.
	This occurs in the worst case $O(|L|)$ times,
	once for each literal if all literals are assigned in in this unit propagation phase.
	Then comes the symmetry propagation phase, which iterates through all symmetries in $O(|\mathcal{S}|)$.
	If the symmetry propagation phase found a (weakly) active symmetry and propagated that,
	the propagation will repeat.
	In total this process can repeat more than $O(|L|)$ times,
	so the total worst-case complexity of the lookahead can be simplified to $O(|L|(|T| + |\mathcal{S}|))$.
	

	It is thus not feasible in general to perform this procedure for every undecided variable and
	select the optimal one.
	Note that this approach also takes into account inverting literals,
	because these literals also cause a symmetry to become weakly inactive.
	% We can still also do inactive propagation optimization after our heuristic.
	
	Several alternative approaches can be considered:

	\begin{enumerate}
		\item An obvious option is to perform a lookahead on the choice variable $v$ that the solver
			selects (based on the variable heap and activity\todo{ref}) to determine the
			preferred assignment ($v$ or $\neg v$).

		\item Additionally, one could perform this lookahead for the $n$ most eligible variables
			and select the one that makes the least symmetries inactive.
			By combining this with other heuristics on selecting the most elgiible variables,
			a much faster runtime may be achieved.

		\item It is also possible to instead approximate the amount of symmetries made inactive under the
			assignment that the propagation of $l$ will yield.
			Instead of propagating, we can look at the number of symmetries made inactive by $l$
			under the current assignment, that is: consider a symmetry $\sigma$ as
			made inactive by $l$ if it is weakly active under the current assignment $\alpha$ and
			$\sigma(l) \notin \alpha$.
			Note that this is an approximation only, as these symmetries could be made active by
			unit propagation after choosing $l$.
			\todoi{give arguments to support this approximation}
	\end{enumerate}

\subsection{Symmetry Counting}
	Following the line of thought that keeping a maximum amount of symmetries active,
	we thought of Symmetry Counting, where the number of symmetries a literal is part of is taken into account.
	We choose first the literal that is involved with as many symmetries as possible.
	The reasoning is that choosing these literals first, will allow these large symmetries to become more weakly active.

	The implementation of this heuristic involves getting the number of symmetries a literal is involved with,
	which is a constant time $O(1)$ operation.
	Doing this for each literal means a total runtime of $O(|L|)$, where $L$ is the set of literals.


\subsection{Symmetry Usage}
	Symmetry Usage is a dynamical symmetry breaking heuristic
	which takes into account the number of times a symmetry has previously been used in the solver tree.
	If a symmetry is used often when solving the tree, we suppose that it is more important than other symmetries.

	When fixing a choice literal, those that are used in commonly used symmetries, are chosen first.
	The implementation is a simple counter that is increased by 1 for each usage of the symmetry.
	The main runtime drawback of this heuristic, is looping through all symmetries a literal is involved in.
	We do this for each literal, which has a runtime of $O(|L|)$.
	The other additional operations are of a constant time complexity $O(1)$, thus the additional overhead is $O(s|L|)$,
	where $s$ is the maximum number of symmetries a literal is involved in.

	
\subsection{Ranking Symmetries}
	By looking at the importance of certain symmetries it is possible to predict
	which symmetries may be better to keep (weakly) active than other symmetries.
	\todoi{Who proposed this?}
